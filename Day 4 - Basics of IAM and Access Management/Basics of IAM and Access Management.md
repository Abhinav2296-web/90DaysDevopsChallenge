## 1. Introduction to IAM (Identity and Access Management)

### What is IAM?
- AWS Identity and Access Management (IAM) allows you to manage access to AWS services and resources securely.
- You can use IAM to create and manage AWS users and groups and assign permissions to allow or deny their access to AWS resources.


[![](https://img.youtube.com/vi/E0hm3tkNqAg/0.jpg)](https://www.youtube.com/watch?v=E0hm3tkNqAg)

[Watch the video](https://www.youtube.com/watch?v=E0hm3tkNqAg)


### Why is IAM Important?
1. **Security**: Control who can access your resources.
2. **Granular Permissions**: Assign specific permissions to users or groups.
3. **Multi-Factor Authentication (MFA)**: Adds an extra layer of security.
4. **Temporary Access**: Roles for delegation and service access.
5. **Centralized Management**: Manage multiple users under one AWS account.

---

## 2. Core IAM Concepts

| Concept  | Description |
|----------|-------------|
| **User** | An individual with long-term credentials to access AWS resources. |
| **Group** | A collection of IAM users with common permissions. |
| **Role** | Temporary credentials granted to users or services to access resources. |
| **Policy** | A document that defines permissions using JSON format. |
| **MFA** | An additional authentication layer requiring a second factor (like OTP) along with a password. |

---

## 3. Creating an IAM User

### Step 1: Open the IAM Console
1. Sign in to the AWS Management Console.
2. Navigate to **IAM** from the services list.

### Step 2: Create a User
1. Click on **Users** from the left panel.
2. Click **Add users**.
3. Enter the Username (e.g., `devops-user`).
4. Select AWS credential type:
   - **Access key**: For programmatic access (CLI/SDK).
   - **Password**: For AWS Management Console access.
5. Click **Next: Permissions**.

### Step 3: Attach Policies
1. Choose how to set permissions:
   - Attach existing policies directly.
   - Add user to a group.
   - Copy permissions from an existing user.
2. Select the **AdministratorAccess** policy for full permissions (for this example).
3. Click **Next: Tags (optional)**.
4. Click **Next: Review**.
5. Review the details and click **Create user**.

### Step 4: Save Credentials
- Download the `.csv` file containing:
  - **Access Key ID**
  - **Secret Access Key**
- **Never share your credentials publicly!**

---

## 4. Creating an IAM Group

### Step 1: Navigate to Groups
1. In the IAM Console, click **Groups** from the sidebar.
2. Click **Create New Group**.

### Step 2: Configure Group Details
1. Enter a **Group Name** (e.g., `DevOpsTeam`).
2. Attach a policy:
   - Search for **AdministratorAccess**.
   - Check the box to select it.
3. Click **Create Group**.

### Step 3: Add Users to the Group
1. Go to the **Users** section.
2. Select the user (`devops-user`).
3. Click **Add to group** and choose **DevOpsTeam**.

---

## 5. Creating an IAM Role

### What are IAM Roles?
Roles grant temporary access to AWS resources without needing long-term credentials. They are useful for:
- Applications running on EC2 instances.
- AWS services accessing other AWS services.
- Cross-account access.

### Step 1: Create a Role
1. Go to the **IAM Console** and click **Roles**.
2. Click **Create role**.

### Step 2: Choose Trusted Entity
- Choose **AWS service** (e.g., **EC2**).

### Step 3: Attach Policies
- Attach the **AmazonS3FullAccess** policy to allow S3 access.
- Click **Next**.

### Step 4: Review and Create
- Name the role as `ec2-s3-access-role`.
- Review and click **Create role**.

---

## 6. Setting Up Multi-Factor Authentication (MFA)

### Step 1: Enable MFA
1. In the **IAM Console**, go to **Users**.
2. Select your IAM user and go to the **Security credentials** tab.
3. Click **Manage MFA**.

### Step 2: Configure MFA Device
- Choose **Virtual MFA device**.
- Use an app like **Google Authenticator** or **Authy**.

### Step 3: Activate MFA
1. Scan the QR code from the MFA app.
2. Enter two consecutive MFA codes generated by the app.
3. Click **Activate MFA**.

---

## 7. Attaching Policies to IAM Roles and Users

### Step 1: Understanding Policies
- Policies are **JSON documents** that define permissions.
- **Structure**:
  - **Version**: Version of the policy language.
  - **Statement**: Contains:
    - **Effect**: Allow or Deny.
    - **Action**: Specific API actions.
    - **Resource**: Specifies the applicable resource(s).

### Step 2: Sample Policy
```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": "s3:*",
      "Resource": "*"
    }
  ]
}
```
This policy allows full access to all S3 resources.

### Step 3: Attaching the Policy
1. Go to **IAM Console**.
2. Navigate to **Users** or **Roles**.
3. Click **Permissions > Add permissions**.
4. Attach the policy by searching for it.
5. Click **Add permissions**.

---

## 8. Verifying Permissions with AWS CLI

### Check User Identity
```sh
aws sts get-caller-identity
```

### Check Role Permissions
Assuming the role:
```sh
aws sts assume-role --role-arn arn:aws:iam::123456789012:role/ec2-s3-access-role --role-session-name devops-session
```

---

## 9. IAM Best Practices

1. **Least Privilege Principle**: Grant only the necessary permissions.
2. **Use IAM Roles for Applications**: Avoid embedding credentials directly into code.
3. **Enable MFA for Root Account**: Always secure your root account with MFA.
4. **Rotate Access Keys Regularly**: Update and rotate keys to reduce security risks.
5. **Monitor IAM Activity**: Use AWS **CloudTrail** to track user activity.

---

## 10. Hands-On Activity

### **Task 1: Create an IAM User and Attach Policy**
1. Create a user with **programmatic access**.
2. Attach **AmazonEC2FullAccess** policy.
3. Verify using:
   ```sh
   aws ec2 describe-instances
   ```

### **Task 2: Create a Role and Assign It to an EC2 Instance**
1. Create a role with **AmazonS3FullAccess**.
2. Attach the role to an existing **EC2 instance**.
3. Verify S3 access from the instance:
   ```sh
   aws s3 ls
   ```

